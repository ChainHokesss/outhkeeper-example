[
  {
    "id": "ory:kratos:public",
    "upstream": {
      "preserve_host": true,
      "url": "${KRATOS_URL}",
      "strip_path": "/.ory/kratos/public"
    },
    "match": {
      "url": "${OUTHKEEPER_URL}/.ory/kratos/public/<**>",
      "methods": ["GET", "POST", "PUT", "DELETE", "PATCH"]
    },
    "authenticators": [
      {
        "handler": "noop"
      }
    ],
    "authorizer": {
      "handler": "allow"
    },
    "mutators": [
      {
        "handler": "noop"
      }
    ]
  },
  {
    "id": "ory:kratos-selfservice-ui-node:anonymous",
    "upstream": {
      "preserve_host": true,
      "url": "${KRATOS_UI_URL}"
    },
    "match": {
      "url": "${OUTHKEEPER_URL}/<{registration,welcome,recovery,verification,login,error,health/{alive,ready},**.css,**.js,**.png,**.svg,**.woff*}>",
      "methods": ["GET"]
    },
    "authenticators": [
      {
        "handler": "anonymous"
      }
    ],
    "authorizer": {
      "handler": "allow"
    },
    "mutators": [
      {
        "handler": "noop"
      }
    ]
  },
  {
    "id": "ory:kratos-selfservice-ui-node:protected",
    "upstream": {
      "preserve_host": true,
      "url": "${KRATOS_UI_URL}"
    },
    "match": {
      "url": "${OUTHKEEPER_URL}/<{sessions,settings}>",
      "methods": ["GET"]
    },
    "authenticators": [
      {
        "handler": "cookie_session"
      }
    ],
    "authorizer": {
      "handler": "allow"
    },
    "mutators": [
      {
        "handler": "id_token"
      }
    ],
    "errors": [
      {
        "handler": "redirect",
        "config": {
          "to": "${OUTHKEEPER_URL}/login"
        }
      }
    ]
  },
  {
    "id": "whitesnake:recruitment:public",
    "upstream": {
      "preserve_host": true,
      "url": "${API_URL}"
    },
    "match": {
      "url": "${OUTHKEEPER_URL}/<{api/docs,openapi.json}>",
      "methods": ["GET"]
    },
    "authenticators": [
      {
        "handler": "noop"
      }
    ],
    "authorizer": {
      "handler": "allow"
    },
    "mutators": [
      {
        "handler": "noop"
      }
    ]
  },
  {
    "id": "whitesnake:recruitment:protected",
    "upstream": {
      "preserve_host": true,
      "url": "${API_URL}"
    },
    "match": {
      "url": "${OUTHKEEPER_URL}/api/v1/<**>",
      "methods": ["GET", "POST", "PUT", "DELETE", "PATCH"]
    },
    "authenticators": [
      {
        "handler": "cookie_session"
      }
    ],
    "authorizer": {
      "handler": "allow"
    },
    "mutators": [
      {
        "handler": "header"
      }
    ],
    "errors": [
      {
        "handler": "redirect",
        "config": {
          "to": "${OUTHKEEPER_URL}/login"
        }
      }
    ]
  }
]
